<!DOCTYPE html>
<meta charset="utf-8">

<!-- Load d3.js -->
<script src="https://d3js.org/d3.v4.js"></script>

<!-- Function for radial charts -->
<script src="https://cdn.jsdelivr.net/gh/holtzy/D3-graph-gallery@master/LIB/d3-scale-radial.js"></script>

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300" rel='stylesheet' type='text/css'>

<!-- Create a div where the graph will take place -->
<div id="my_dataviz"></div>
<!-- <div id = "my_chosen"style = "position:absolute; left:1460px; top: 650px; background-color:black;"></div>
 --><div id = "my_radar"style = "position:absolute; left:1420px; top: 500px; background-color:black;"></div>

<!-- //<button onclick="window.location='http://www.example.com';">Visit Page Now</button>
 -->


   <!-- add div of top 5 songs -->
   <div class="l-song-index-content--side">
    <table class="song-index-table tabItems">
      <thead>
          <tr id = "top5header">Top 5 Songs with highest feature values</tr>
      </thead>
      <tbody class="tabItem song-trend-Acousticness" style="display: none">
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">1st</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101626867-e056fa00-3a60-11eb-99f6-f1319fa5931b.jpg" width=90></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">When I Was Your Man</div>
                  <div class="song-index-table__position">Bruno Mars</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2013</td>
          </tr>
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">2nd</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101626731-bbfb1d80-3a60-11eb-936a-96e378ad840e.jpg"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">All Of Me</div>
                  <div class="song-index-table__position">John Legend</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2014</td>
          </tr>
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">3rd</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101626855-ddf4a000-3a60-11eb-8e11-5915c2319f78.jpg"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">Someone Like You</div>
                  <div class="song-index-table__position">Adele</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2011</td>
          </tr>
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">4th</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101626838-d92fec00-3a60-11eb-8681-9cac2dbe972e.jpeg"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">Hey There Delilah</div>
                  <div class="song-index-table__position">Plain White T's</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2007</td>
          </tr>
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">5th</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101626847-db924600-3a60-11eb-8fcc-45f1934170a6.jpg"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">Love Yourself</div>
                  <div class="song-index-table__position">Justin Bieber</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2016</td>
          </tr>
      </tbody>
      <tbody class="tabItem song-trend-Danceability" style="display: none">
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">1st</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101630007-93295700-3a65-11eb-9bb3-7e2816e24e7b.jpg"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">Give It To Me</div>
                  <div class="song-index-table__position">Timbaland</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2007</td>
          </tr>
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">2nd</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101630014-97ee0b00-3a65-11eb-9200-801fc1678248.png"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">Hot In Herre</div>
                  <div class="song-index-table__position">Nelly</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2002</td>
          </tr>
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">3rd</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101630169-d71c5c00-3a65-11eb-8fcc-5ca5ecb73dc4.jpg"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">Temperature</div>
                  <div class="song-index-table__position">Sean Paul</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2006</td>
          </tr>
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">4th</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101630330-19de3400-3a66-11eb-82ef-7f7783a50344.png"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">Hollaback Girl</div>
                  <div class="song-index-table__position">Gwen Stefani</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2005</td>
          </tr>
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">5th</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101630502-4b56ff80-3a66-11eb-8444-e64f5f568719.jpg"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">Bodak Yellow</div>
                  <div class="song-index-table__position">Cardi B</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2017</td>
          </tr>
      </tbody>
      <tbody class="tabItem song-trend-Energy" style="display: none">
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">1st</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101632668-932b5600-3a69-11eb-8e4b-8a2c67c2b935.jpg"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">Promiscuous</div>
                  <div class="song-index-table__position">Nelly Furtado</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2006</td>
          </tr>
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">2nd</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101632699-9b839100-3a69-11eb-92d1-ba3def958c4c.jpg"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">Hey Ya!</div>
                  <div class="song-index-table__position">OutKast</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2004</td>
          </tr>
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">3rd</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101632712-9f171800-3a69-11eb-8e0f-90687f877093.jpg"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">Girlfriend</div>
                  <div class="song-index-table__position">Avril Lavigne</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2007</td>
          </tr>
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">4th</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101632724-a3433580-3a69-11eb-85be-a6bc8e744cc2.jpg"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">Not Afraid</div>
                  <div class="song-index-table__position">Eminem</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2010</td>
          </tr>
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">5th</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101632761-ab9b7080-3a69-11eb-93fc-90dae7ad677f.jpg"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">Whistle</div>
                  <div class="song-index-table__position">Flo Rida</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2012</td>
          </tr>
      </tbody>
      <tbody class="tabItem song-trend-Tempo" style>
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">1st</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101633033-0c2aad80-3a6a-11eb-8cf8-b99033b5b00c.png"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">Starboy</div>
                  <div class="song-index-table__position">The Weeknd</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2017</td>
          </tr>
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">2nd</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101633055-13ea5200-3a6a-11eb-96e0-93fb2aa9d588.jpg"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">Fireflies</div>
                  <div class="song-index-table__position">Owl City</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2009</td>
          </tr>
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">3rd</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101633064-177dd900-3a6a-11eb-8350-03e3521c28f3.png"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">Roar</div>
                  <div class="song-index-table__position">Katy Perry</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2013</td>
          </tr>
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">4th</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101633074-1cdb2380-3a6a-11eb-85ce-fdf8fb998d1a.jpg"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">Despacito</div>
                  <div class="song-index-table__position">Luis Fonsi, Daddy Yankee</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2017</td>
          </tr>
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">5th</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101633082-206eaa80-3a6a-11eb-8250-9b9bf6eeb471.jpg"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">Genie In A Bottle</div>
                  <div class="song-index-table__position">Christina Aguilera</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">1999</td>
          </tr>
      </tbody>
      <tbody class="tabItem song-trend-Valence" style="display: none">
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">1st</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101633097-25335e80-3a6a-11eb-8d64-2ea0da22f1a3.jpg"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">Family Affair</div>
                  <div class="song-index-table__position">Mary J.Blige</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2001</td>
          </tr>
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">2nd</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101632699-9b839100-3a69-11eb-92d1-ba3def958c4c.jpg"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">Hey Ya!</div>
                  <div class="song-index-table__position">OutKast</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2004</td>
          </tr>
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">3rd</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101633109-282e4f00-3a6a-11eb-830b-671bf2ab6eb0.png"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">All About That Bass</div>
                  <div class="song-index-table__position">Meghan Trainor</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2014</td>
          </tr>
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">4th</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101633121-2cf30300-3a6a-11eb-8263-5d0955bd074b.png"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">Sucker</div>
                  <div class="song-index-table__position">Jonas Brothers</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2019</td>
          </tr>
          <tr>
              <td class="song-index-table__cell song-index-table__cell--rank">5th</td>
              <td class="song-index-table__cell song-index-table__cell--image">
                  <img class="album_images" src="https://user-images.githubusercontent.com/67447280/101633142-32e8e400-3a6a-11eb-8422-552592cb4b81.png"></img>
              </td>
              <td class="song-index-table__cell song-index-table__cell--song">
                  <div class="song-index-table__name">Shake It Off</div>
                  <div class="song-index-table__position">Taylor Swift</div>
              </td>
              <td class="song-index-table__cell song-index-table__cell--year">2014</td>
          </tr>
      </tbody>
    </table>
  </div>
</div>


<!-- <script>
  function visitPage(){
      window.location='./question/Question.html';
  }
</script>
<button class="button" onclick="visitPage();">üé∂ Take Survey to Find Your Cluster!</button>
<style> -->
<!-- 
.button{
‚ÄÉdisplay:inline-block;
‚ÄÉpadding:0.35em 1.2em;
‚ÄÉborder:0.1em solid #FFFFFF;
‚ÄÉmargin:0 0.3em 0.3em 0;
‚ÄÉborder-radius:0.12em;
‚ÄÉbox-sizing: border-box;
‚ÄÉtext-decoration:none;
‚ÄÉfont-family:'Roboto',sans-serif;
‚ÄÉfont-weight:300;
‚ÄÉtext-align:center;
‚ÄÉtransition: all 0.2s;
 background-color: #C4C4C4;
 color: black;
 padding: 15px 32px;
 font-size: 16px;
 margin: 4px 2px;
 cursor: pointer;
}
.button:hover{
‚ÄÉcolor:#000000;
‚ÄÉbackground-color:#FFFFFF;
}
@media all and (max-width:30em){
.button{
‚ÄÉ‚ÄÉdisplay:block;
‚ÄÉ‚ÄÉmargin:0.4em auto;
}
/*   .button {
    background-color: #4B4B4B;
    border: none;
    color: white;
    padding: 15px 32px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 4px 2px;
    cursor: pointer;
  } */}
</style> -->



<!-- style of top 5 songs -->
<style>
  body {
    width: 2100px;
    height: 100%;
  }

  #linkcontainer {
    text-align: center;
  }

  #questionlink:hover {
    background-color: #C4C4C4;
  }
  #questionlink {
    text-decoration: none;
    color: black;
    border: 1px solid black;
    padding: 10px;
    border-radius: 8px;
    font-size: 20px;
  }
  .song-index-table {
      width: 100%;
      /* table-layout: fixed; */
      border-collapse: collapse;
  }
  
  img {
    width: 85px;
    height: 85px;
    object-fit: cover;
  }
  thead {
      display: table-header-group;
      vertical-align: middle;
  }
  tbody {
      vertical-align: middle;
  }
  tr {
      display: table-row;
      vertical-align: inherit;
      border-color: inherit;
      border-top-color: inherit;
      border-right-color: inherit;
      border-bottom-color: inherit;
      border-left-color: inherit;
  }
  
  td {
      display: table-cell;
      vertical-align: inherit;
  }
  table {
      border-collapse: collapse;
      border-spacing: 0;
      -webkit-border-horizontal-spacing: 0px;
      -webkit-border-vertical-spacing: 0px;
  }
  table {
      border-collapse: separate;
      text-indent: initial;
      border-spacing: 2px;
      -webkit-border-horizontal-spacing: 2px;
      -webkit-border-vertical-spacing: 2px;
  }
  /* #e6e6e6 */
  .song-index-table__cell {
      background-color: #fff;
      border-top: solid 1px black;
          border-top-width: 1px;
          border-top-style: solid;
          border-top-color: black;
      border-bottom: solid 1px black;
          border-bottom-width: 1px;
          border-bottom-style: solid;
          border-bottom-color:black;
          border-bottom-left-radius: 8px;
          border-bottom-right-radius: 8px;
      height: 60px;
      vertical-align: middle;
  }
  .song-index-table__cell:first-child {
      border-left: solid 1px #e6e6e6;
  }
  .song-index-table__cell--rank {
      line-height: 18px;
      font-family: Helvetica,AppleSDGothic,"Apple SD Gothic Neo",AppleGothic,Arial,Tahoma;
      font-size: 16px;
      font-weight: 300;
      font-style: italic;
      text-align: center;
      color: #8b8b8b;
      width: 60px;
  }
  .song-index-table__cell--image {
      font-size: 0;
      width: 60px;
      height: 100px;
  }
  .song-index-table__cell--song {
      padding-left: 6px;
      line-height: 15px;
      font-size: 12px;
      text-align: left;
      color: #b6b6b6;
      width: 100px;
  }
  .song-index-table__cell--year {
      padding-left: 1px;
      line-height: 14px;
      font-family: Helvetica,AppleSDGothic,"Apple SD Gothic Neo",AppleGothic,Arial,Tahoma;
      font-size: 12px;
      text-align: center;
      color: #b6b6b6;
      width: 60px;
  }
  .song-index-table__name {
      color: black;
  }
  /* small, div, p, span, button {
      font-family: Helvetica,"Malgun Gothic","Apple SD Gothic Neo",AppleGothic,Dotum,Arial,Tahoma;
  } */
  :root {
      --HSDSGlobalFontFamily: "Aktiv Grotesk","Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";
      --HSDSGlobalFontFamilyMono: "SFMono-Regular",Consolas,"Liberation Mono",Menlo,Courier,monospace;
      --HSDSGlobalFontSize: 13px;
  }
  html {
      font-family: sans-serif;
      -webkit-text-size-adjust: 100%;
      -ms-text-size-adjust: 100%;
  }
  
  /* rgb(233, 239, 244) */
  /*  #e9eff4 */
  .l-song-index-content--side {
      margin-right: 70px;
      float: right;
      width: 400px;
      background-color: #f9f9fa;
      border: solid 1px black;
      border-top-color: black;
      border-top-style: solid;
      border-top-width: 1px;
      border-right-color:black;
      border-right-style: solid;
      border-right-width: 1px;
      border-bottom-color: black;
      border-bottom-style: solid;
      border-bottom-width: 1px;
      border-left-color:black;
      border-left-style: solid;
      border-left-width: 1px;
      border-image-source: initial;
      border-image-slice: initial;
      border-image-width: initial;
      border-image-outset: initial;
      border-image-repeat: initial;
      box-sizing: border-box;
      margin-top: -1000px;
      font-family: 'Open Sans';
      text-align: center;
      font-weight: bold;
      border-radius: 8px;
  }
  
  </style>


<style>
  #table_title {
    font-size: 50px;

  }
</style>
<style>
body {
  font-family: Univers, Arial, sans-serif;
}

.button rect {
  stroke: black; /* navy 40% */
  stroke-width: 0.8px;
}

.button rect.pressed {
  fill: #C4C4C4; /* navy 100% */
}

.button #gradient-start {
  stop-color: white; /* navy 40% */
  stop-opacity: 1;
}

.button #gradient-stop {
  stop-color: white; /* navy 70% */
  stop-opacity: 1;
}

.button #gradient-start.active, .button #gradient-start.pressed {
  stop-color: #C4C4C4; /* navy 70% */
}

.button #gradient-stop.active, .button #gradient-stop.pressed {
  stop-color: #C4C4C4; /* navy 100% */
}

.button text {
  font-size: 14px;
  fill: black;
  pointer-events: none;
  text-anchor: middle;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
}
  
  </style>

<script>
d3.button = function() {

var dispatch = d3.dispatch('press', 'release');

var padding = 5,
    radius = 5,
    stdDeviation = 0,
    offsetX = 0,
    offsetY = 0;

function my(selection) {
  selection.each(function(d, i) {
    var g = d3.select(this)
        .attr('id', 'd3-button' + i)
        .attr('transform', 'translate(' + d.x + ',' + d.y + ')');

    var text = g.append('text').text(d.label);
    var defs = g.append('defs');
    var bbox = text.node().getBBox();
    var rect = g.insert('rect', 'text')
        .attr("x", bbox.x - padding)
        .attr("y", bbox.y - padding)
        .attr("width", bbox.width + 2 * padding)
        .attr("height", bbox.height + 2 * padding)
        .attr('rx', radius)
        .attr('ry', radius)
        .on('mouseover', activate)
        .on('mouseout', deactivate)
        .on('click', toggle)

     addShadow.call(g.node(), d, i);
     addGradient.call(g.node(), d, i);
  });
}

function addGradient(d, i) {
  var defs = d3.select(this).select('defs');
  var gradient = defs.append('linearGradient')
      .attr('id', 'gradient' + i)
      .attr('x1', '0%')
      .attr('y1', '0%')
      .attr('x2', '0%')
      .attr('y2', '100%');

  gradient.append('stop')
      .attr('id', 'gradient-start')
      .attr('offset', '0%')

  gradient.append('stop')
      .attr('id', 'gradient-stop')
      .attr('offset', '100%')

  d3.select(this).select('rect').attr('fill', 'url(#gradient' + i + ")" );
}

function addShadow(d, i) {
  var defs = d3.select(this).select('defs');
  var rect = d3.select(this).select('rect').attr('filter', 'url(#dropShadow' + i + ")" );
  var shadow = defs.append('filter')
      .attr('id', 'dropShadow' + i)
      .attr('x', rect.attr('x'))
      .attr('y', rect.attr('y'))
      .attr('width', rect.attr('width') + offsetX)
      .attr('height', rect.attr('height') + offsetY)

  shadow.append('feGaussianBlur')
      .attr('in', 'SourceAlpha')
      .attr('stdDeviation', 0)

  shadow.append('feOffset')
      .attr('dx', offsetX)
      .attr('dy', offsetY);

  var merge = shadow.append('feMerge');

  merge.append('feMergeNode');
  merge.append('feMergeNode').attr('in', 'SourceGraphic');
}

function activate() {
  var gradient = d3.select(this.parentNode).select('linearGradient')
  d3.select(this.parentNode).select("rect").classed('active', true)
  if (!gradient.node()) return;
  gradient.select('#gradient-start').classed('active', true)
  gradient.select('#gradient-stop').classed('active', true)
}

function deactivate() {
  var gradient = d3.select(this.parentNode).select('linearGradient')
  d3.select(this.parentNode).select("rect").classed('active', false)
  if (!gradient.node()) return;
  gradient.select('#gradient-start').classed('active', false);
  gradient.select('#gradient-stop').classed('active', false);
}

function toggle(d, i) {
  if (d3.select(this).classed('pressed')) {
      release.call(this, d, i);
      deactivate.call(this, d, i);
  } else {
      press.call(this, d, i);
      activate.call(this, d, i);
  }
}
 
function press(d, i) {
  dispatch.call('press', this, d, i)
  d3.select(this).classed('pressed', true);
  var shadow = d3.select(this.parentNode).select('filter')
  if (!shadow.node()) return;
  shadow.select('feOffset').attr('dx', 0).attr('dy', 0);
  shadow.select('feGaussianBlur').attr('stdDeviation', 0);
}

function release(d, i) {
  dispatch.call('release', this, d, i)
  my.clear.call(this, d, i);
}

my.clear = function(d, i) {
  d3.select(this).classed('pressed', false);
  var shadow = d3.select(this.parentNode).select('filter')
  if (!shadow.node()) return;
  shadow.select('feOffset').attr('dx', offsetX).attr('dy', offsetY);
  shadow.select('feGaussianBlur').attr('stdDeviation', stdDeviation);
}

my.on = function() {
  var value = dispatch.on.apply(dispatch, arguments);
  return value === dispatch ? my : value;
};





return my;
}
</script>




<script>
//  function visitPage(){
//       window.location='./question/Question.html';
//   }
    // set the dimensions and margins of the graph
    var margin = {top: 0, right: 0, bottom: 0, left: 300},
        width = 1950 - margin.left - margin.right,
        height = 1250 - margin.top - margin.bottom,
        innerRadius = 200,
        // outerRadius = Math.min(width, height) / 2;   // the outerRadius goes from the middle of the SVG area to the border
        outerRadius = 350;

    

    // append the svg object
    var svg = d3.select("#my_dataviz")
      .append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        //.style("background", "#a7b9b9")
      .append("g")
        .attr("transform", "translate(" + (width / 2 + margin.left) + "," + (height / 2 + margin.top) + ")");
    
    
    var button_data = [{label: "üéª Acousticness", csv_label: "Acousticness", color: "purple", x: -260, y: -500},
                        {label: "üíÉ Danceability", csv_label: "Danceability", color: "orange", x: -110, y: -500},
                        {label:  "‚ö° Energy", csv_label: "Energy", color: "skyblue", x: 20, y: -500},
                        {label: "‚åõ Tempo", csv_label: "Tempo", color: "#8597d0", x: 130, y: -500},
                        {label: "üò¢ Valence", csv_label: "Valence", color: "blue", x: 240, y: -500}
                        ];

    var sort_button_data = [{label: "üé∏ Acousticness", csv_label: "Acousticness", x: -340, y: -430},
                        {label: "üï∫ Danceability", csv_label: "Danceability", x: -190, y: -430},
                        {label: "üîã Energy", csv_label: "Energy", x: -53, y: -430},
                        {label: "‚è±Ô∏è Tempo", csv_label: "Tempo", x: 48, y: -430},
                        {label: "üòÉ Valence", csv_label: "Valence", x: 150, y: -430},
                        ];
 
   //var move_button_data = [{label: "üé∂ Take Survey to Find Your Cluster!", x: -800, y: 260}];
                        
    

    var button = d3.button()
        .on('press', function(d, i) { clearAll(); })
      
    function clearAll() {
      buttons.selectAll('rect')
          .each(function(d, i) { button.clear.call(this, d, i) });
    }

    //var sort_button = d3.button();
    var buttons = d3.button();
    //var move_button = d3.button();


    var buttons = svg.selectAll(".button")
        .data(button_data)
        .enter()
        .append("g")
        .attr("class", "button")
        .style("fill", "#eee")
        .call(button)
        
       

/* 
    var move_button = svg.selectAll(".move_button")
        .data(move_button_data)
        .enter()
        .append("g")
        .append("a")
            .attr("xlink:href", "./question/Question.html")
        .attr("class", "move_button_data")
        .style("fill", "white")
        .call(move_button)
        
        move_button.on("click", function() {
          console.log('i was clicked');
        }) */

       


      //Annotation ÎçîÌïòÍ∏∞ 
      const annotation = d3.select('#my_dataviz')
                           .append("div")
                           .attr("class", "annotation")   
                           .style("position", "absolute")
                           .style("visibility", "visible")
                           .style("top", 70+"px")
                           .style("left",10+"px")
                          
                           .style("width", '592px')
                           .style("height", '900px')
                          .html("<p class='annotation'>"+"<strong><big><big>An Interactive Visualization of Billboard Song Clusters</big></big></strong>"
                            +"<br>By Team M&L from SNU"
                            +"<br><br><br><br>When our team first met, we realized we were all music enthusiasts. So we tried searching for music related data, and found a dataset with numerical audio features (provided by Spotify) on songs from the Billboard (1999 - 2019). You can find the data <a href = 'https://www.kaggle.com/danield2255/data-on-songs-from-billboard-19992019' target = '_blank'>here.</a>"

                            +"<br><br>With the dataset, we wanted to explore topics like trends and clustering. Thus, we used the audio feature values to form unique vectors for each song and performed k-means clustering to produce 5 clusters. Since we wondered if people with different tastes would fit in different clusters, we used the data to create a survey that leads to visualizations of a billboard song cluster that best defines a person."
                            +"<br><br>Before the survery, a circular bar chart of the no.1 billboard songs is shown for an understanding of the features, their relations, and possible trends. The bar lengths represent each song‚Äôs feature value ratio to the max feature value in the dataset, and you can check the exact ratios by hovering. Try to pick a song you know, imagine the features the song may have, and compare with the actual data! You can choose which feature to see and how to sort it on the top. Here is an explanation of each feature."
         
                            
                            
                            

                            +"<br><br>"+"<strong><u><big>"+'Acousticness'+"</strong></u>"+": Whether the track is acoustic"
                            +"<br>"+"<strong><u>"+"Danceability"+"</strong></u>"+": How suitable a track is for dancing"
                            +"<br>"+"<strong><u>"+"Energy"+"</strong></u>"+": Perceptual measure of intensity and activity"
                            +"<br>"+"<strong><u>"+"Key"+"</strong></u>"+": Estimated overall key of the track"
                            +"<br>"+"<strong><u>"+"Tempo"+"</strong></u>"+": Overall estimated tempo of a track in beats per minute (BPM)"
                            +"<br>"+"<strong><u>"+"Valence"+"</strong></u>"+': Musical positiveness conveyed by a track'
                            +"</big><br><br>To discover relations between features, try sorting features with other features "
                            +"<br>(ex. Whether more acoustics songs are slower). "
                            +"<br><br>To discover trends, try to sort each feature by year "
                            +"<br>(ex. If overall valence changes over time)."
                            +"<br><br>Now, click the button below to discover your music cluster! "
                            +"<em>"+"<br>P.S. Pay attention to the background colors as you answer the questions " +"</em>"+" üòä"  
                            +"<br><br><br><div id = 'linkcontainer'><a id = 'questionlink' href = ./question/Question.html>üé∂ Take Survey to Find Your Cluster!</a></div>"

                            //"<a href ='./question/Question.html'>"
                            )
                            .style("font-size", "14px")
                            .style("border", "1px solid black")
                            .style("padding", "10px")
                            .style("border-radius", "10px")
                        //.style("box-shadow", "2px 2px 2px 0px black")
                        .style("font-family", "Open Sans")


                        
      const questiontitle = d3.select('#my_dataviz')
                           .append("div")
                           .attr("class", "annotation")   
                           .style("position", "absolute")
                           .style("visibility", "visible")
                           .style("top", 135+"px")
                           .style("left",50+"px")
                          .html("<p class='annotation'>"+"<i>"+'"Can music be represented with numbers?"'+"</i>" 
                            )
                            .style("font-size", "20px")
                        .style("font-family", "Open Sans")
                        .style("text-align", "center")
                        .style("text-transform", "uppercase"); 

      const pagetitle = d3.select('#my_dataviz')
                           .append("div")
                           .attr("class", "annotation")   
                           .style("position", "absolute")
                           .style("visibility", "visible")
                           .style("top", 70+"px")
                           .style("left",870+"px")
                          .html("<span class='annotation'>" + "Which feature do you want to see?</span>"
                            )
                            .style("font-size", "25px")
                        .style("font-family", "Open Sans")
                        .style("text-align", "center")
                        .style("text-transform", "uppercase"); 
      
      const pagetitle2 = d3.select('#my_dataviz')
                           .append("div")
                           .attr("class", "annotation")   
                           .style("position", "absolute")
                           .style("visibility", "visible")
                           .style("top", 150+"px")
                           .style("left",870+"px")
                           .html("<span id='p_sorting_buttons' class='annotation' style='display: inline-block'>"
                           +"Which feature do you want to sort by?&emsp;</span>"                             )
                            .style("font-size", "20px")
                        .style("font-family", "Open Sans")
                        .style("text-align", "center")
                        .style("text-transform", "uppercase"); 

        var sorting_buttons = d3.select("#p_sorting_buttons")
							.append('select').html('<option hidden="" selected="">Select one..</option>')
	      sorting_buttons.selectAll(".sort_button")
        .data(sort_button_data)
        .enter()
        .append("option")
        .text(function (d) { return d.label; }) // text showed in the menu
		.attr("value", function (d) { return d.csv_label; }) // corresponding value returned by the button


        //var move_button = d3.select("#page_move_button")
        //.append('select') 
    //TOOLTIP ÎçîÌïòÍ∏∞
/* 
    const rectTooltip = d3.select('#my_space')
                            .append("div")
                            .attr("class", "tooltip")   
                            .style("position", "absolute")
                            .style("visibility", "hidden");

      */
     
     
     
/*     var move_button = svg.selectAll(".move_button_data")
        .data(move_button_data)
        .enter()
        .append("g")
        .append("a")
            .attr("xlink:href", "./question/Question.html")
        .attr("class", "move_button_data")
        .style("fill", "#F2D7D5")
        
        .call(button)
        .on("mouseover", function() {
          d3.select(this)
            .style("fill", "skyblue");
            
        })
        .on("mouseout", function() {
          d3.select(this)
            .style("fill", "#F2D7D5");
        })
        
    
 */
    // ÏãúÏûëÏ†ê ÎÅùÏ†ê ÌëúÏãú
    svg
      .append('rect')
        .attr('x', 0)
        .attr('y', -200)
        .attr('width',1)
        .attr('height', 30)
        .attr('stroke', '#d13232')
        .attr('fill', '#69a3b2');

    svg.append('text')
        .attr('x',7)
        .attr('y', -180)
        .attr('stroke','#444040')
        .style('font-size', 10)
        .text("Highest");

    svg.append('text')
        .attr('x',-40)
        .attr('y', -180)
        .attr('stroke','#444040')
        .style('font-size', 10)
        .text("Lowest");              
    // csv ÌååÏùº ÏùΩÍ∏∞
    // d3.csv("https://raw.githubusercontent.com/datawhales/DataVisualization/master/songs500.csv", function(data) {
    d3.csv("https://raw.githubusercontent.com/datawhales/DataVisualization/master/1strankedsongs.csv", function(data) {
      // Í∏∞Î≥∏Ï†ÅÏúºÎ°ú ÏùåÎ∞ò Î∞úÌñâ ÎÖÑÎèÑÎ°ú sorting
      data.sort((a,b) => {
        return d3.descending(a['Year'], b['Year'])
      });

      // Scales
      var x = d3.scaleBand()
          .range([0, 2 * Math.PI])    // X axis goes from 0 to 2pi = all around the circle. If I stop at 1Pi, it will be around a half circle
          .align(0)                  // This does nothing
          .domain(data.map(function(d) { return d.Title; })); // The domain of the X axis is the list of states.
      var y = d3.scaleRadial()
          .range([innerRadius, outerRadius])   // Domain will be define later.
          .domain([0, 100]); // Domain of Y is from 0 to the max seen in the data
    
      // Add the bars
      var bars = svg.append("g")
        .selectAll("path")
        .data(data)
        .enter()
        .append("path")
          .attr("fill", "#8597d0")
          .attr("d", d3.arc()     // imagine your doing a part of a donut plot
              .innerRadius(innerRadius)
              .outerRadius(function(d) { return y(100* d['Tempo']); })
              .startAngle(function(d) { return x(d.Title); })
              .endAngle(function(d) { return x(d.Title) + x.bandwidth(); })
              .padAngle(0.01)
              .padRadius(innerRadius))
          .on('mouseover', function (d,i) {
            bars
              .style("fill-opacity", 0.5);

            d3.select(this)
                .style("fill", "red")
                .style("fill-opacity", 1)
                .attr("d", d3.arc()
                .innerRadius(innerRadius)
                .outerRadius(function(d) { return y(120* d['Tempo']); })
                .startAngle(function(d) { return x(d.Title) - 0.5 * x.bandwidth(); })
                .endAngle(function(d) { return x(d.Title) + 1.5 * x.bandwidth(); })
                .padAngle(0.01)
                .padRadius(innerRadius));
              
            const percentage = 100 * d['Tempo']

            const title = d.Title
            const artist = d['Artist']
            const year = d['Year'];

            centerlabel
                .style("visibility", null)
                .select(".percentage")
                .text(percentage.toFixed(2) + "%");
            centerlabel
                .select(".title")
                .text("\"" + title + "\"");
            centerlabel
                .select(".year")
                .text("in " + year);
            centerlabel
                .select(".artist")
                .text("by " + artist);
          })
          .on('mouseout', function() {
            bars
              .style("fill-opacity", 1);

            d3.select(this)
                .style("fill", "#8597d0")
                .style("fill-opacity", 1)
                .attr("d", d3.arc()     // imagine your doing a part of a donut plot
                .innerRadius(innerRadius)
                .outerRadius(function(d) { return y(100* d['Tempo']); })
                .startAngle(function(d) { return x(d.Title); })
                .endAngle(function(d) { return x(d.Title) + x.bandwidth(); })
                .padAngle(0.01)
                .padRadius(innerRadius))

            centerlabel
                .style("visibility", "hidden");
          })
          

      // Add the labels
      var songlabels = svg.append("g")
          .selectAll("g")
          .data(data)
          .enter()
          .append("g")
            .attr("text-anchor", function(d) { return (x(d.Title) + x.bandwidth() / 2 + Math.PI)
              % (2 * Math.PI) < Math.PI ? "end" : "start"; })
            .attr("transform", function(d) { return "rotate(" + ((x(d.Title) + x.bandwidth() / 2) 
            * 180 / Math.PI - 90) + ")"+"translate(" + (y(100 * d['Tempo'])+10) + ",0)"; })
          .append("text")
          .attr("class", "songtitles")
            .text(function(d){return(d.Title)})
            .attr("transform", function(d) { return (x(d.Title) + x.bandwidth() / 2 + Math.PI) 
              % (2 * Math.PI) < Math.PI ? "rotate(180)" : "rotate(0)"; })
            .style("font-size", "9px")
            .attr("alignment-baseline", "middle")


            ////////////////////////////////////
          //////// sorting_buttons ÏãúÏûë ///////
          ////////////////////////////////////

         var selected = "Year";          
          sorting_buttons
          .on("change", function(selectedOption) {
				     var selectedOption = d3.select(this).property("value")
             selected = selectedOption;
            //  d3.selectAll(".chosen").remove();
              bars.exit().remove();
              songlabels.exit().remove();
              svg.selectAll(".songtitles").remove();

              data.sort((a,b) => {
                return d3.descending(a[selectedOption], b[selectedOption])

              });



              var sorting = selectedOption.toString()
              d3.select(this)
                .style("fill", "red");

              // data ÏóÖÎç∞Ïù¥Ìä∏ - sortingÌïú dataÎ°ú chart Í∑∏Î¶¨Í∏∞
          // Scales
            x
            .domain(data.map(function(d) { return d.Title; })); // The domain of the X axis is the list of states.
            
          bars
            .data(data)
            .enter()
            .append("path")
            .on('mouseover', function (d,i) {
              bars
                .style("fill-opacity", 0.5);

              d3.select(this)
                .style("fill", "red")
                .style("fill-opacity", 1)
                .attr("d", d3.arc()
                .innerRadius(innerRadius)
                .outerRadius(function(d) { return y(120* d['Tempo']); })
                .startAngle(function(d) { return x(d.Title) - 0.5 * x.bandwidth(); })
                .endAngle(function(d) { return x(d.Title) + 1.5 * x.bandwidth(); })
                .padAngle(0.01)
                .padRadius(innerRadius));
              
              const percentage = 100 * d['Tempo']
              const title = d.Title
              const artist = d['Artist']
              const year = d['Year']; 

              centerlabel
                .style("visibility", null)
                .select(".percentage")
                .text(percentage.toFixed(2) + "%");
              centerlabel
                .select(".title")
                .text("\"" + title + "\"");
              centerlabel
                .select(".year")
                .text("in " + year);
              centerlabel
                .select(".artist")
                  .text("by " + artist);
            })
          
          // bars mouseout
          bars
          .on('mouseout', function() {
            bars
              .style("fill-opacity", 1);

            d3.select(this)
                .style("fill", "#8597d0")
                .style("fill-opacity", 1)
                .attr("d", d3.arc()     // imagine your doing a part of a donut plot
                .innerRadius(innerRadius)
                .outerRadius(function(d) { return y(100* d['Tempo']); })
                .startAngle(function(d) { return x(d.Title); })
                .endAngle(function(d) { return x(d.Title) + x.bandwidth(); })
                .padAngle(0.01)
                .padRadius(innerRadius))

            centerlabel
                .style("visibility", "hidden");
          })
          
          // bars transition
          bars
            .transition().duration(1500)
            .style("fill", "#8597d0")
            .attr("d", d3.arc()     // imagine your doing a part of a donut plot
              .innerRadius(innerRadius)
              .outerRadius(function(d) { return y(100* d['Tempo']); })
              .startAngle(function(d) { return x(d.Title); })
              .endAngle(function(d) { return x(d.Title) + x.bandwidth(); })
              .padAngle(0.01)
              .padRadius(innerRadius))


          // Add the labels
          svg
            .append("g")
            .selectAll("g")
            .data(data)
            .enter()
            .append("g")
              .attr("text-anchor", function(d) { return (x(d.Title) + x.bandwidth() / 2 + Math.PI) 
                % (2 * Math.PI) < Math.PI ? "end" : "start"; })
              .attr("transform", function(d) { return "rotate(" + ((x(d.Title) + x.bandwidth() / 2) 
              * 180 / Math.PI - 90) + ")"+"translate(" + (y(100 * d['Tempo']) + 10) + ",0)"; })
            .append("text")
            .attr("class", "songtitles")
              .text(function(d){return(d.Title)})
              .attr("transform", function(d) { return (x(d.Title) + x.bandwidth() / 2 + Math.PI) 
                % (2 * Math.PI) < Math.PI ? "rotate(180)" : "rotate(0)"; })
              .style("font-size", "9px")
              .attr("alignment-baseline", "middle")


            })
       /////////////////////////////////////////////
      //////////// sorting ÌÅ¥Î¶≠ Ïãú Î≥ÄÌôî ÎÅù ///////////////
      //////////////////////////////////////////////

      //////////////////////////////////////////////
      //////////// Î≤ÑÌäº ÌÅ¥Î¶≠ Ïãú Î≥ÄÌôî ÏãúÏûë ///////////////
      //////////////////////////////////////////////

      console.log(selected)


      buttons
        .on("click", function(button_d, button_i) {
          d3.select(this)
           // d3.selectAll(".chosen").remove();

            d3.select(".song-trend-Acousticness")
            .style("display", "none");
          d3.select(".song-trend-Danceability")
            .style("display", "none");
          d3.select(".song-trend-Energy")
            .style("display", "none");
          d3.select(".song-trend-Tempo")
            .style("display", "none");
          d3.select(".song-trend-Valence")
            .style("display", "none");

/*             return rectTooltip.style("visibility", "visible").style("top"+80+"px").style("left"+620+"px")
            .html("<p class='tooltip'>"  +"Max excluding outlier:"                  
            ).style("font-size", "12px").style("background", "white").style("border", "1px solid black").style("padding", "2px")
            .style("box-shadow", "2px 2px 2px 0px black").style("font-family", "verdana"); 
           */

          bars
            .on('mouseover', function (d,i) {
              bars
                .style("fill-opacity", 0.5);

              d3.select(this)
                .style("fill", "red")
                .style("fill-opacity", 1)
                .attr("d", d3.arc()
                .innerRadius(innerRadius)
                .outerRadius(function(d) { return y(120 * d[button_d.csv_label]); })
                .startAngle(function(d) { return x(d.Title) - 0.5 * x.bandwidth(); })
                .endAngle(function(d) { return x(d.Title) + 1.5 * x.bandwidth(); })
                .padAngle(0.01)
                .padRadius(innerRadius));
              
              const percentage = 100 * d[button_d.csv_label]
              const title = d.Title
              const artist = d['Artist']
              const year = d['Year'];

              centerlabel
                .style("visibility", null)
                .select(".percentage")
                .text(percentage.toFixed(2) + "%");
              centerlabel
                .select(".title")
                .text("\"" + title + "\"");
              centerlabel
                .select(".year")
                .text("in " + year);
              centerlabel
                .select(".artist")
                  .text("by " + artist);
            })
          
          // bars mouseout
          bars
          .on('mouseout', function() {
            bars
              .style("fill-opacity", 1);

            d3.select(this)
                .style("fill", button_d.color)
                .style("fill-opacity", 1)
                .attr("d", d3.arc()     // imagine your doing a part of a donut plot
                .innerRadius(innerRadius)
                .outerRadius(function(d) { return y(100* d[button_d.csv_label]); })
                .startAngle(function(d) { return x(d.Title); })
                .endAngle(function(d) { return x(d.Title) + x.bandwidth(); })
                .padAngle(0.01)
                .padRadius(innerRadius))

            centerlabel
                .style("visibility", "hidden");
          })
          
          // bars transition
          bars
            .transition().duration(1500)
            .style("fill", button_d.color)
            .attr("d", d3.arc()     // imagine your doing a part of a donut plot
              .innerRadius(innerRadius)
              .outerRadius(function(d) { return y(100* d[button_d.csv_label]); })
              .startAngle(function(d) { return x(d.Title); })
              .endAngle(function(d) { return x(d.Title) + x.bandwidth(); })
              .padAngle(0.01)
              .padRadius(innerRadius))
        
          svg.selectAll(".songtitles").remove();
          // songlabels.remove();

          svg
            .append("g")
            .selectAll("g")
            .data(data)
            .enter()
            .append("g")
              .attr("text-anchor", function(d) { return (x(d.Title) + x.bandwidth() / 2 + Math.PI) 
                % (2 * Math.PI) < Math.PI ? "end" : "start"; })
              .attr("transform", function(d) { return "rotate(" + ((x(d.Title) + x.bandwidth() / 2) 
              * 180 / Math.PI - 90) + ")"+"translate(" + (y(100 * d[button_d.csv_label]) + 10) + ",0)"; })
            .append("text")
            .attr("class", "songtitles")
              .text(function(d){return(d.Title)})
              .attr("transform", function(d) { return (x(d.Title) + x.bandwidth() / 2 + Math.PI) 
                % (2 * Math.PI) < Math.PI ? "rotate(180)" : "rotate(0)"; })
              .style("font-size", "9px")
              .attr("alignment-baseline", "middle")

            d3.select(".song-trend-" + button_d.csv_label)
            .style("display", null);
          ////////////////////////////////////
          //////// sorting_buttons ÏãúÏûë ///////
          ////////////////////////////////////
          sorting_buttons
            .on("change", function(selectedOption) {
              var selectedOption = d3.select(this).property("value")

              bars.exit().remove();
              songlabels.exit().remove();
              svg.selectAll(".songtitles").remove();
              //d3.selectAll(".chosen").remove();

              data.sort((a,b) => {
                return d3.descending(a[selectedOption], b[selectedOption])
              });

              d3.select(this)
                .style("fill", "red");


              // data ÏóÖÎç∞Ïù¥Ìä∏ - sortingÌïú dataÎ°ú chart Í∑∏Î¶¨Í∏∞
          // Scales
            x
            .domain(data.map(function(d) { return d.Title; })); // The domain of the X axis is the list of states.
            
          bars
            
            .data(data)
            .enter()
            .append("path")
            .on('mouseover', function (d,i) {
              bars
                .style("fill-opacity", 0.5);

              d3.select(this)
                .style("fill", "red")
                .style("fill-opacity", 1)
                .attr("d", d3.arc()
                .innerRadius(innerRadius)
                .outerRadius(function(d) { return y(120* d[button_d.csv_label]); })
                .startAngle(function(d) { return x(d.Title) - 0.5 * x.bandwidth(); })
                .endAngle(function(d) { return x(d.Title) + 1.5 * x.bandwidth(); })
                .padAngle(0.01)
                .padRadius(innerRadius));
              
              const percentage = 100 * d[button_d.csv_label]
              const title = d.Title
              const artist = d['Artist']
              const year = d['Year'];

              centerlabel
                .style("visibility", null)
                .select(".percentage")
                .text(percentage.toFixed(2) + "%");
              centerlabel
                .select(".title")
                .text("\"" + title + "\"");
              centerlabel
                .select(".year")
                .text("in " + year);
              centerlabel
                .select(".artist")
                  .text("by " + artist);
            })
          
          // bars mouseout
          bars
          .on('mouseout', function() {
            bars
              .style("fill-opacity", 1);

            d3.select(this)
                .style("fill", button_d.color)
                .style("fill-opacity", 1)
                .attr("d", d3.arc()     // imagine your doing a part of a donut plot
                .innerRadius(innerRadius)
                .outerRadius(function(d) { return y(100* d[button_d.csv_label]); })
                .startAngle(function(d) { return x(d.Title); })
                .endAngle(function(d) { return x(d.Title) + x.bandwidth(); })
                .padAngle(0.01)
                .padRadius(innerRadius))

            centerlabel
                .style("visibility", "hidden");
          })
          
          // bars transition
          bars
            .transition().duration(1500)
            .style("fill", button_d.color)
            .attr("d", d3.arc()     // imagine your doing a part of a donut plot
              .innerRadius(innerRadius)
              .outerRadius(function(d) { return y(100* d[button_d.csv_label]); })
              .startAngle(function(d) { return x(d.Title); })
              .endAngle(function(d) { return x(d.Title) + x.bandwidth(); })
              .padAngle(0.01)
              .padRadius(innerRadius))


          // Add the labels
          svg
            .append("g")
            .selectAll("g")
            .data(data)
            .enter()
            .append("g")
              .attr("text-anchor", function(d) { return (x(d.Title) + x.bandwidth() / 2 + Math.PI) % (2 * Math.PI) < Math.PI ? "end" : "start"; })
              .attr("transform", function(d) { return "rotate(" + ((x(d.Title) + x.bandwidth() / 2) * 180 / Math.PI - 90) + ")"+"translate(" + (y(100 * d[button_d.csv_label]) + 10) + ",0)"; })
            .append("text")
            .attr("class", "songtitles")
              .text(function(d){return(d.Title)})
              .attr("transform", function(d) { return (x(d.Title) + x.bandwidth() / 2 + Math.PI) % (2 * Math.PI) < Math.PI ? "rotate(180)" : "rotate(0)"; })
              .style("font-size", "9px")
              .attr("alignment-baseline", "middle")

  
              
            var attrib = button_d.csv_label.toString()
            var sorting = selectedOption
            var color = button_d.color.toString()

            console.log(attrib)
            console.log(selectedOption)
            console.log(color)

            ////////////////////////////
            // Add chosen table //
            ////////////////////////////
/* 
            var anno2 = d3.select('#my_chosen')
                           .append("div")
                           .attr("class", "chosen")   
                           .style("position", "absolute")
                           .style("visibility", "visible")
                           .style("top", 20+"px")
                           .style("left",0+"px")
                           .style("width", 420 +"px")
                           .style("height", 120 +"px")
                           .style("background-color", color)

                          .html("<p class='annotation'>"+"Feature Name : " +"<br><strong><big><big>"+attrib+ "</big></big></strong>" 
                            +"<br>Sort by : "+"<br><strong><big><big>"+ sorting+ "</big></big></strong>" 
                            +"<br><br><br><br>"

                            
                            )
                            .style("font-size", "13.5px")
                            .style("border", "3px solid black")
                            .style("padding", "3px")
                        //.style("box-shadow", "2px 2px 2px 0px black")
                        .style("font-family", "Candara")
                        .style("text-align", "center")
 */

            ////////////////////////////
            // Add radar //
            ////////////////////////////
            var radarTooltip = d3.select('body').append("div").attr("id", "tooltip-radar-chart")
                .style("position", "absolute").style("z-index", "10").style("visibility", "hidden")
                .style("top", 0).style("left", 0)

            ////////////////////////////
            // Add Top 10 songs table //
            ////////////////////////////
             
             var htmls = d3.select("#my_table")
             .append("div")
             .attr("w3-include-html","song.html")
/*              
              var tabulate = function (data,columns) {
                var table = d3.select("#my_table")
                              .append('table')
                              .attr("class", "top10table")
                              
	              var thead = table.append('thead')
	              var tbody = table.append('tbody')
              thead.append('tr')
                .selectAll('th')
                .data(columns)
                .enter()
                .append('th')
                .text(function (d) { return d })
               var rows = tbody.selectAll('tr')
                   .data(data)
                   .enter()
                   .append('tr')
                var cells = rows.selectAll('td')
                    .data(function(row) {
                	    return columns.map(function (column) {
                		    return { column: column, value: row[column] }
                        })
                      })
                      .enter()
                      .append('td')
                      .text(function (d) { return d.value })
                    
                      return table;
              } */


              ////////////////////////////////
              // Add Top 10 songs table end //
              ////////////////////////////////

         
              
          })
          ////////////////////////////////////
          //////// sorting_buttons ÎÅù ///////
          ////////////////////////////////////
        })
        ///////////////////////////////////////////////
        //////////// Î≤ÑÌäº ÌÅ¥Î¶≠ Ïãú Î≥ÄÌôî ÎÅù /////////////////
        //////////////////////////////////////////////
        

      // center text
      const centerlabel = svg
        .append("text")
        .attr("text-anchor", "middle")
        .attr("fill", "#888")
        .style("visibility", "hidden");
    
      centerlabel
        .append("tspan")
        .attr("class", "title")
        .attr("x", 0)
        .attr("y", 0)
        .attr("dy", "-2.6em")
        .attr("font-size", "2em")
        .text("");

      centerlabel
        .append("tspan")
        .attr("class", "artist")
        .attr("x", 0)
        .attr("y", 0)
        .attr("dy", "-1.6em")
        .attr("font-size", "2em")
        .text("");

      centerlabel
        .append("tspan")
        .attr("class", "year")
        .attr("x", 0)
        .attr("y", 0)
        .attr("dy", "-0.6em")
        .attr("font-size", "2em")
        .text("");

      centerlabel
        .append("tspan")
        .attr("class", "percentage")
        .attr("x", 0)
        .attr("y", 0)
        .attr("dy", "+0.6em")
        .attr("font-size", "2em")
        .text("");

      
    })


    </script>
    
